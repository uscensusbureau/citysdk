{"version":3,"file":"ajax.xhrio.js","sources":["ajax/xhrio.cljs"],"mappings":"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","names":["temp__5457__auto__","response-type","response-format","G__24298","G__24297","G__24299","G__24300","p1__24292#","goog.events/listen","goog.net.EventType/COMPLETE","G__24296","cljs.core.js__GT_clj.cljs$core$IFn$_invoke$arity$1","this","uri","method","body","headers","timeout","with-credentials","cljs.core/name","cljs.core/clj->js","header","goog.net.ErrorCode/ABORT","p__24293","map__24294","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","cljs.core.get.cljs$core$IFn$_invoke$arity$3","cljs.core/fn?","progress-handler","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","G__24301","handler","goog/net.EventType.UPLOAD_PROGRESS","p__24325","map__24326","goog/net.XhrIo","goog/net.XhrManager","priority","max-retries","id"],"sourcesContent":["(ns ajax.xhrio\n  (:require goog.net.EventType\n            goog.net.ErrorCode\n            [goog.net.XhrIo :as xhr]\n            [goog.net.XhrManager :as xhrm]\n            [goog.Uri :as uri]\n            [goog.json :as goog-json]\n            [goog.events :as events]\n            [ajax.protocols :refer [AjaxImpl AjaxRequest\n                                    AjaxResponse Interceptor]]))\n\n(extend-type goog.net.XhrIo\n  AjaxImpl\n  (-js-ajax-request\n    [this\n     {:keys [uri method body headers timeout with-credentials\n             response-format progress-handler]\n      :or {with-credentials false\n           timeout 0}}\n     handler]\n    (when-let [response-type (:type response-format)]\n      (.setResponseType this (name response-type)))\n    (when (fn? progress-handler)\n      (doto this\n        (.setProgressEventsEnabled true)\n        (events/listen goog.net.EventType.UPLOAD_PROGRESS progress-handler)))\n    (doto this\n      (events/listen goog.net.EventType/COMPLETE\n                     #(handler (.-target %)))\n      (.setTimeoutInterval timeout)\n      (.setWithCredentials with-credentials)\n      (.send uri method body (clj->js headers))))\n  AjaxRequest\n  (-abort [this] (.abort this goog.net.ErrorCode/ABORT))\n  AjaxResponse\n  (-body [this] (.getResponse this))\n  (-status [this] (.getStatus this))\n  (-status-text [this] (.getStatusText this))\n  (-get-all-headers [this]\n    (js->clj (.getResponseHeaders this)))\n  (-get-response-header [this header]\n    (.getResponseHeader this header))\n  (-was-aborted [this]\n    (= (.getLastErrorCode this) goog.net.ErrorCode/ABORT)))\n\n(extend-type goog.net.XhrManager\n  AjaxImpl\n  (-js-ajax-request\n    [this {:keys [uri method body headers\n                  id timeout priority max-retries]\n           :or {timeout 0}}\n     handler]\n    (.send this id uri method body (clj->js headers)\n           priority handler max-retries)))\n"]}